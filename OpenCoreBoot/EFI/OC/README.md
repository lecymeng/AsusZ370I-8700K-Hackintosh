## OC For Weicools'iMac

### configFinal

- [x] WiFi（）
- [x] Bluetooth（）
- [x] CPU
- [x] 内存
- [x] 独显RX570
- [x] 核显UHD630
- [x] 显示器4K U2777B
- [x] USB端口定制 - 定制完成（`USBPort.kext`），定制USB时使用（需要搭配 `USBInjectAll.kext` 和 `XHCI-unsupported.kext`，开启OC里面解除15端口限制的config：Kernel--Quirks--XhciPortLimit）
- [x] WiFi PCI Patch（可能效果和没这个Patch没有区别，改DeviceProperties）
- [x] Add USBPower.kext，加快充电速度（[参考xjn819](https://blog.xjn819.com/?p=543)：**3.7.2 USBX供电**）



### USB定制

`USBInjectAll.kext` + `XHCI-unsupported.kext` 驱动USB缺点：无法内建，影响睡眠

定制USB时需要搭配 `USBInjectAll.kext` 和 `XHCI-unsupported.kext`，开启OC里面解除15端口限制的config：Kernel--Quirks--XhciPortLimit



#### 多余端口

- [ ] ~~USR2~~
- [ ] ~~USR1~~

#### 内置端口

- [x] HS13
- [x] HS14

#### 前置端口

- [x] SS01
- [x] HS01
- [x] HS11
- [ ] ~~HS12 移除~~

#### 后置端口

- [x] HS03
- [x] SS03
- [ ] ~~HS04 移除~~
- [ ] ~~SS04 移除~~
- [x] HS05
- [x] SS05
- [x] HS06
- [x] SS06

- [x] HS07
- [ ] ~~SS07~~

- [x] HS08
- [ ] ~~SS08~~

- [x] HS09
- [ ] ~~SS09~~

- [x] HS10
- [ ] ~~SS10~~

### 排列启动盘

我们首先要对Config—Misc—Security—scanpolicy这个值进行修改，默认的是0，代表着扫描所有硬盘。

#### OC-引导扫描策略

设置位置：`Misc\Security\ScanPolicy`

-  （01）0x00000001 — 限定为文件系统，由以下`允许扫描文件系统子项`开启
-  （02）0x00000002 — 限定为设备类型，由以下`允许扫描设备类型子项`开启

  `允许扫描文件系统子项`：

-  （03）0x00000100 — 允许扫描APFS文件系统
-  （04）0x00000200 — 允许扫描HFS文件系统
-  （05）0x00000400 — 允许扫描EFI系统分区文件系统

  `允许扫描设备类型子项`：

-  （06）0x00010000 — 允许扫描SATA设备
-  （07）0x00020000 — 允许扫描SAS和Mac NVMe设备
-  （08）0x00040000 — 允许扫描SCSI设备
-  （09）0x00080000 — 允许扫描NVMe设备
-  （10）0x00100000 — 允许扫描CD / DVD设备
-  （11）0x00200000 — 允许扫描USB设备
-  （12）0x00400000 — 允许扫描FireWire设备
-  （13）0x00800000 — 允许扫描读卡器设备



 **扫描策略数值** =（01）+（02）+1个或数个`允许扫描文件系统子项`+1个或数个`允许扫描设备类型子项`

> 例如：希望扫描对象是APFS文件系统的USB设备，`扫描策略数值`=（01）+（02）+（03）+（11）
>
> = 0x00000001 + 0x00000002 + 0x00000100 + 0x00200000 
>
> = 0x00200103 再转为十进制
>
> = 2097411

- `0` — 允许扫描所有已知文件系统+允许扫描所有已知设备类型
- `F0103` — 官方推荐值： (01) + (02) + (03) + (06) + (07) + (08) + (09) ，最终`扫描策略数值` = `983299`
- `2F0303` — 官方推荐值(F0103) + (04) + (11) = (01) + (02) + (03) + (04)  + (06) + (07) + (08) + (09) + (11)，最终`扫描策略数值` = `3080963`

我们这里让OC只扫描MAC盘。根据说明： (01) +  (02) 是必须选的；因为我的MAC是APFS，所以系统子项类我选 (3) ；我的MAC是安装在SATA上的，所以我在设备类型上选择 (06) ，如果你是安装在NVME盘上的，你应该选 (09) 。

这样我们的公式就是：

```
(1) + (2) + (3) + (6) = 0x00000001+0x00000002+0x00000100+0x00010000 = 0x00010103 = 65795
```

